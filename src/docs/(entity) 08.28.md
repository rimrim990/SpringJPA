# (08.28) Spring JPA

## 엔티티 설계시 주의점
### 엔티티에는 가급적 Setter 를 사용하지 말자
- 유지보수가 어렵다.

### 모든 연관관계는 지연로딩으로 설정 !
- 즉시 로딩은 관련된 테이블을 함께 로딩해온다. 
- 즉시 로딩 (EAGER) 은 예측이 어렵고, 어떤 SQL 이 실행될지 추적이 어렵다.
- 특히 JPQL 을 실행할 때 N+1 문제가 자주 발생한다.
- 연관된 엔티티를 함께 DB 에서 조회해야 하면, fetch join 또는 엔티티 그래프 기능을 사용한다.
- @XToOne 은 기본 fetch 전략이 EAGER 이므로 LAZY 타입으로 바꿔줘야 한다.

### N+1 Query Problem
- 쿼리 1번으로 N 건을 가져왔는데, 관련 컬럼을 얻기 위해 쿼리를 N 번 추가 수행하는 문제 

### 테이블, 컬럼명 생성 전략
- 스프링 부트에서 하이버네이트 기본 매핑 전략을 변경해서 실제 테이블 필드명은 다름
  - 카멜 케이스 -> 언더 스코어 (memberPoint -> member_point)
  - .(점) -> _(언더스코어)
  - 대문자 -> 소문자

### CASCADE
- 특정 엔티티에 작업을 수행하면, 관련된 엔티티에도 동일한 작업이 수행된다.
- 부모 엔티티를 영속화할 때 자식 엔티티도 같이 영속화되거나, 부모 엔티티가 삭제될 때 자식 엔티티도 같이 삭제되는 등

### 연관관계 메서드